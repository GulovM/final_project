# **Создание новой БД с помощью *dbca*.**
    1. Запустить `dbca` на сервере или виртуальной машине. 
        Database Operations: Выбрать опцию *"Create a database"* и нажать "Next".
    
    2. Выбор шаблона базы данных (Creation Mode):
        Выбрать "Advanced Mode" для большего контроля над параметрами. 
        Deployment Type: Затем выбрать шаблон "General Purpose or Transaction Processing".
    
    3. Базовая информация о базе данных (Database Identification):
        Ввести имя базы данных (Global Database Name) и SID (System Identifier). В моем случае:
            Global Database Name: finalproject
            SID: finalproject
        Убрать галочку с "Create as Container Database", если она стоит
        
    4. Storage option: Переключить radiobutton на "Use folowing for the ...." и убрать галочку с "Use Oracle-Managed Files"

    5. Fast recovery option: убрать все галочки и нажать Next

    6. Network Configuration: выбрать существующий Listener или создать новый

    7. Data Vault Option: убрать все галочки, если они стоят

    8. Configuration options: Выбрать метод управления памятью "Automatic Shared Memory Management". Настроить параметры SGA и PGA, если это необходимо.
        Затем в вкладке Sample Schemas поставить галочку на "Add sample...".

    9. Managments Options: убрать все галочки

    10. User credentials: выбрать "Use the same administative..." и ввести пароль

    11. Creation Option: ставим галочку только на Create Database и нажимаем Next
    Далее нажимаем Finish и ждем загрузки. При окончании загруски нажимаем close.

# Команды по шагам 2-4:
### 2. Создайте пользователей с различными уровнями привилегий (администратор базы данных, пользователь, ограниченный пользователь (только чтение данных)). Каждому пользователю назначьте отдельное табличное пространство:
---
```bash
sqlplus / as sysdba
```
* Создание табличных пространств:
    ---
    ```sql
    CREATE TABLESPACE admin_tbs DATAFILE 'admin_tbs01.dbf' SIZE 50M;
    CREATE TABLESPACE user_tbs DATAFILE 'user_tbs01.dbf' SIZE 50M;
    CREATE TABLESPACE readonly_tbs DATAFILE 'readonly_tbs01.dbf' SIZE 50M;
    ```
* Создание пользователей с различными привилегиями:
    ---
    ```sql
    CREATE USER admin_user IDENTIFIED BY password DEFAULT TABLESPACE admin_tbs;
    GRANT DBA TO admin_user;
    CREATE USER normal_user IDENTIFIED BY password DEFAULT TABLESPACE user_tbs;
    GRANT CREATE SESSION TO normal_user;
    GRANT CREATE TABLE TO normal_user;
    GRANT CREATE VIEW TO normal_user;
    CREATE USER readonly_user IDENTIFIED BY password DEFAULT TABLESPACE readonly_tbs;
    GRANT CREATE SESSION TO readonly_user;
    GRANT SELECT ANY TABLE TO readonly_user;
    ```
### 3. Для каждого пользователя создайте таблицы и наполните их данными:
* Для пользователя **admin_user**:
    ---
    ```bash
    sqlplus admin_user/password
    ```
    ---
    ```sql
    --- создание таблицы employees
    CREATE TABLE employees (
    employee_id NUMBER GENERATED BY DEFAULT AS IDENTITY,
    first_name VARCHAR2(50),
    last_name VARCHAR2(50),
    email VARCHAR2(100),
    hire_date DATE,
    salary NUMBER(8, 2),
    PRIMARY KEY (employee_id)
    );
    --- заполнение таблицы employees
    INSERT INTO employees (first_name, last_name, email, hire_date, salary) VALUES ('John', 'Doe', 'john.doe@example.com', SYSDATE, 50000);
    INSERT INTO employees (first_name, last_name, email, hire_date, salary) VALUES ('Jane', 'Smith', 'jane.smith@example.com', SYSDATE, 60000);
    --- создание таблицы departments
    CREATE TABLE departments (
        department_id NUMBER GENERATED BY DEFAULT AS IDENTITY,
        department_name VARCHAR2(100),
        location VARCHAR2(100),
        PRIMARY KEY (department_id)
    );
    --- заполнение таблицы departments
    INSERT INTO departments (department_name, location) VALUES ('HR', 'New York');
    INSERT INTO departments (department_name, location) VALUES ('Engineering', 'San Francisco');
    ```
* Для пользователя nowmal_user:
    ---
    ```bash
    sqlplus admin_user/password
    ```
    ---
    ```sql
    CREATE TABLE projects (
    project_id NUMBER GENERATED BY DEFAULT AS IDENTITY,
    project_name VARCHAR2(100),
    start_date DATE,
    end_date DATE,
    budget NUMBER(10, 2),
    PRIMARY KEY (project_id)
    );
    INSERT INTO projects (project_name, start_date, end_date, budget) VALUES ('Project Alpha', SYSDATE, SYSDATE + 30, 100000);
    INSERT INTO projects (project_name, start_date, end_date, budget) VALUES ('Project Beta', SYSDATE, SYSDATE + 60, 200000);
    ```
### 4. Покажите как можно управлять табличным пространством - расширьте датафайл имеющегося табличного пространства, добавьте новый датафайл в имеющееся табличное пространство:
* Расширение файла табличного пространства:
    ---
    ```sql
    ALTER DATABASE DATAFILE 'admin_tbs01.dbf' RESIZE 100M;
    ```
* Добавление нового файла к табличному пространству:
    ---
    ```sql
    ALTER TABLESPACE user_tbs ADD DATAFILE 'user_tbs02.dbf' SIZE 50M;
    ```

# Скрипты шагов 5-6:
## 5. Создайте скрипт для для экспорта одной любой схемы с помощью инструмента data pump. Опишите также процесс импорта этой схемы.
* Создание каталога на сервере для импорта дампа:
    ---
    ```sql
    CREATE OR REPLACE DIRECTORY dpump_dir AS '/tmp';
    GRANT READ, WRITE ON DIRECTORY dpump_dir TO admin_user;
    ```
* Создание скрипта для импорта схемы:
    ---
    ```bash
    touch import_schema.sh
    nano import_schema.sh
    ```
    Добавляем в файл скрипт:
    ---
    ```bash
    #!/bin/bash
    impdp admin_user/password@SID schemas=admin_user directory=dpump_dir dumpfile=admin_user_schema.dmp logfile=admin_user_schema_imp.log
    ```
    Добавляем права на исполнение:
    ---
    ```bash
    chmod +x import_schema.sh
    ```
    Запускаме скрипт:
    ---
    ```bash
    ./import_schema.sh
    ```

#### Описание процесса:
* **Экспорт схемы:**
    ---
    ```bash
    ./export_schema.sh
    ```
    + Команда *expdp* запускает утилиту Data Pump Export.
    + Параметр *schemas* указывает схему для экспорта (в данном случае `admin_user`).
    + Параметр *directory* указывает ранее созданный каталог `dpump_dir`.
    + Параметр *dumpfile* задает имя файла дампа (в данном случае `admin_user_schema.dmp`).
    + Параметр *logfile* задает имя файла журнала экспорта (в данном случае `admin_user_schema_exp.log`).

* **Импорт схемы:**
    ---
    ```bash
    ./import_schema.sh
    ```
    + Команда *impdp* запускает утилиту Data Pump Import.
    + Параметр *schemas* указывает схему для импорта (в данном случае `admin_user`).
    + Параметр *directory* указывает ранее созданный каталог `dpump_dir`.
    + Параметр *dumpfile* задает имя файла дампа для импорта (в данном случае `admin_user_schema.dmp`).
    + Параметр *logfile* задает имя файла журнала импорта (в данном случае `admin_user_schema_imp.log`).
  
## 6. Попробуйте создать rman скрипт для бэкапа всей базы данных. Осуществите запуск rman-скрипта из cron-а. Опишите скрипт, процесс запуска, покажите логи выполнения скрипта.
* Создание RMAN-скрипта:
    Для начала создаем файл для скрипта
    ---
    ```bash
    touch backup_db.rman
    nano backup_db.rman
    ```
    Внутри файла пишем:
    ---
    ```bash
    RUN {
      # Устанавливаем формат файлов бэкапа
      ALLOCATE CHANNEL ch1 DEVICE TYPE DISK FORMAT '/backup/backup_db_%U.bkp';
      
      # Выполняем полный бэкап базы данных
      BACKUP DATABASE PLUS ARCHIVELOG;
      
      # Убираем каналы
      RELEASE CHANNEL ch1;
    }
    ```
    **Описание шагов:**
    * `ALLOCATE CHANNEL`: выделяет канал для выполнения бэкапа. В этом случае используется диск (DEVICE TYPE DISK).
    * `BACKUP DATABASE PLUS ARCHIVELOG`: выполняет полный бэкап базы данных и архивных журналов.
    * `RELEASE CHANNEL`: освобождает ресурсы после завершения бэкапа.
* Запуск RMAN-скрипта вручную:
    ---
    ```bash
    rman target / @backup_db.rman
    ```
    **Здесь:**
    * `target /`: указывает на использование локального подключения к базе данных.
    * `@backup_db.rman`: указывает путь к вашему RMAN-скрипту.
* ### Настройка Cron для автоматизации:
    Создадим задание в crontab для автоматического выполнения RMAN-скрипта ежедневно в 2:00 AM
    * Откроем crontab для редактирования:
        ---
        ```bash
        crontab -e
        ```
    * Добавим строку для выполнения скрипта:
        ---
        ```plaintext
        0 2 * * * /usr/bin/rman target / @/tmp/backup_db.rman > /tmp/backup_log.log 2>&1
        ```
    * Описание скрипта:
        * `0 2 * * *`: указывает на выполнение задания ежедневно в 2:00 AM.
        * `/usr/bin/rman target / @/tmp/backup_db.rman`: команда для выполнения RMAN-скрипта.
        * `> /tmp/backup_log.log 2>&1`: перенаправляет вывод и ошибки в лог-файл.
